## ------------------------------------------------------------------------------------------------------------------------
#| error: true
"hello" + "world"


## ------------------------------------------------------------------------------------------------------------------------
#| warning: true
as.numeric(c("5", "6", "seven"))


## ------------------------------------------------------------------------------------------------------------------------
#| message: true
f <- function() {
    message("This is a message.")
}

f()


## ------------------------------------------------------------------------------------------------------------------------
suppressMessages(f())


## ------------------------------------------------------------------------------------------------------------------------
#| message: true
f2 <- function() {
    message(Sys.time(), " This is a message.")
}

f2()


## ------------------------------------------------------------------------------------------------------------------------
#| error: true
stop("Something erroneous has occurred!")


## ------------------------------------------------------------------------------------------------------------------------
#| error: true
name_of_function <- function() {
    stop("Something bad happened.")
}

name_of_function()


## ------------------------------------------------------------------------------------------------------------------------
#| error: true
error_if_n_is_greater_than_zero <- function(n) {
    stopifnot(n <= 0)
    n
}

error_if_n_is_greater_than_zero(5)


## ------------------------------------------------------------------------------------------------------------------------
#| error: true
error_if_n_squared <- function(n) {
    ## Ok use
    stopifnot(n <= 0)

    ## Create an internal object
    n_squared <- n^2

    ## Not ok, since we are using the internal object n_squared
    stopifnot(n_squared <= 10)
    n
}

error_if_n_squared(-2)

## This generates a confusing error message to our users
error_if_n_squared(-4)


## ------------------------------------------------------------------------------------------------------------------------
#| error: true
fn <- function(x = c("foo", "bar")) {
    x <- rlang::arg_match(x)

    ## Known scenario 1
    if (x == "foo") {
        print("I know what to do here with 'x = foo'")
    }

    ## Known scenario 2
    if (x == "bar") {
        print("I know what to do here with 'x = bar'")
    }
}
fn("foo")
fn("zoo")


## ------------------------------------------------------------------------------------------------------------------------
#| warning: true
warning("Consider yourself warned!")


## ------------------------------------------------------------------------------------------------------------------------
#| warning: true
make_NA <- function(x) {
    warning("Generating an NA.")
    NA
}

make_NA("Sodium")


## ------------------------------------------------------------------------------------------------------------------------
message("In a bottle.")


## ------------------------------------------------------------------------------------------------------------------------
as.numeric(c("5", "6", "seven"))


## ------------------------------------------------------------------------------------------------------------------------
beera <- function(expr) {
    tryCatch(expr,
        error = function(e) {
            message("An error occurred:\n", e)
        },
        warning = function(w) {
            message("A warning occured:\n", w)
        },
        finally = {
            message("Finally done!")
        }
    )
}


## ------------------------------------------------------------------------------------------------------------------------
beera({
    2 + 2
})

beera({
    "two" + 2
})

beera({
    as.numeric(c(1, "two", 3))
})


## ----error=TRUE----------------------------------------------------------------------------------------------------------
is_even <- function(n) {
    n %% 2 == 0
}

is_even(768)

is_even("two")


## ------------------------------------------------------------------------------------------------------------------------
is_even_error <- function(n) {
    tryCatch(n %% 2 == 0,
        error = function(e) {
            FALSE
        }
    )
}

is_even_error(714)

is_even_error("eight")


## ------------------------------------------------------------------------------------------------------------------------
is_even_check <- function(n) {
    is.numeric(n) && n %% 2 == 0
}

is_even_check(1876)

is_even_check("twelve")


## ------------------------------------------------------------------------------------------------------------------------
#| eval: false
## library(microbenchmark)
## microbenchmark(sapply(letters, is_even_check))


## ----eval=FALSE----------------------------------------------------------------------------------------------------------
## microbenchmark(sapply(letters, is_even_error))


## ------------------------------------------------------------------------------------------------------------------------
options(width = 120)
sessioninfo::session_info()

